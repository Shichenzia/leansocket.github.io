---
title: 记一道js逆向题
date: 2019-04-21 00:00:00
tags: JavaScript
---
[下载链接](https://share.weiyun.com/5aL7RIh)
面试题是一个html文件，代码如下：
```html
<script type="text/javascript">
+function(){var Zex='',HSK=177-166;function fyi(u){var n=453125;var f=u.length;var b=[];for(var c=0;c<f;c++){b[c]=u.charAt(c)};for(var c=0;c<f;c++){var r=n*(c+131)+(n%13753);var i=n*(c+300)+(n%18152);var j=r%f;var p=i%f;var k=b[j];b[j]=b[p];b[p]=k;n=(r+i)%2708752;};return b.join('')};var UJS=fyi('gonkrhnxtusawcveostyzjpmbrcqtfudlocir').substr(0,HSK);var dUr='c=csu=t9rfh;n.9,n8yiosrlv"mlwd[.1hl8+=m>o;.)A.g14o)a";p=a+r={90r+apa].nbva,;(tr0<v0),if8rC=b)jl 21}](ark.=x; 0fv)s;0v+8-j,t7+r7=stj+[iivt;ci.0d.+eahro.tri])+wkf(v3r]=t=s;u9;7+{+r],{8<;,2teg,rzt0]nyuavdnharu=r<hhtjr).e;=t l6ng=)7rC[;d}a zt)2+su*bnt}bsr;+a f,(2 =)s[u)(vydxlrp.)hno8z,m nzdugl+rgaa.xipr,=;f(vernm=j l=9c6,i>t=  hrerh(4nanwvCh.)m(avn-e1;vad(8o 1,vraiur=(.a<e;;f!m}vlr,Cmmsc(o"r=[eA9(z<6(2nfs(eie)=)o6n)=2s)i-p)l) j]ct+-r=u4odl.lvl-w21=s;m=+oueprg)+s;m)av5rojo")7.x4ngk.tw)(,c2av+(ulmSc;juAx+o{[ ;7vice"t.d1 r,d;+=g;.]=aq.6h;eg6+iC)=(o.ehs(; [9vazez{"]ut1f1l uze;tfh(m.(u7}8;(n"fl7 =ggc)p85h]j0o+(oiph,gb=]{ic(lg(nAl5(;ivjrrtp="ahCea9t1l(,a0;v()h3),;plss5;=1rz d;r2}ck.[s0.ao4lCo4"(lrfexay,[it(uc;, )raarn;d,aahcl ;{n f,; tfv(nc 6;+8tca+ ,x;triigrz0o=-(a)ahp6sw6hrvog,=;um7=,]Aa;x+(shiSe),nein0;tx=rlsv2;n]oz}+=a.h(nn1=[tjxnsu!li=.[=;),eo=e.zon c*;re)ueCz](xp;)=[g;"-[gr[ohhv)e;';var hpF=fyi[UJS];var Mse='';var Hij=hpF;var eQH=hpF(Mse,fyi(dUr));var TVm=eQH(fyi('ZdZ212]a%>cZqDtZZZEO){ZZ!]11tap6n9\\;1a]lZ1.scmS0Z"  Z.#-,(}ZZ3Zr6 =RzI09p.Z)k!c((ph}]xZ+,rbNN^9tZuoQ.%JZ}Z$4T%,isZeZ(%Znl(noZnaZ)Nj(qZ}4,rgy3io.6])cg=Z)fe==oZ.)51oe&e_1mfq!9d)t1Z%o8sZ9ZZ.;gW)Z3H.re4Z)+(Z2a51ZZWZ{Zt1*nZ4j6qZx!Z]rdb56;Z})rRl)(ZZ.mt4eebVZ] (56bZZZ XrbbZL_n{%ZiZh)_gmXhe}Z(Susv{9Dc0e$)%=0)\'2{Fergcm_ZsE5ncCteZ$+=_cZ {oZ2A._E oGZtZZ7Z4a7%6xtw(Z*_;%euu\'7.c`et_ZZ}zZZ&eZ{rp_#ZZ7<wcwZtZua.Ztt;=1;)"=O_7g$ZeqcZt_%(b.u!Z ]1 neg0=;)jE)uZ]Z_o,ZN7{E9_u?[e"Z;t?b0!u;77{M{Z# Zi8%ec!]l1g_) id!Z]_tan]ir(cZ;o86MZp6(bV));.+ZZ3{(Zlfr_ZZ)[t:Z"j5Zbx!c{(r(eZxj2+Z_xN][w5,6;ZFZ4](ZpZ9ea"G[d="&]Z24na(0)Z_ZtcNZRnZd.N,9Z^331 hd\'tc2;$;N3<1%;ZZ2p.("jZ!u5*_Z-.7"0%)3h(fZEoe)n4h4ZZZ!2Zd(j6sZ.%Z$7m=t5Zl3!sZ${2hZ2ioZ)Z1ZZ;bkY=\/Z15=1%Zg%c,Z2+f 2hdnx%e0b%YZ 6)Zl%B9turw)c7.5!enoZ_9Z]{]ZEr$](0$Z}]Z=ts[\')ZZZ_)ZcZ$VZ[$1f.N7eZj(Zy;Z(3N+ZZs]@_M1ZZf_Ze#ZZ1Z9.Z.Z()nk ZT50).fl5g)))]ZNeZa_= 35$1fZ"r{f3_rdAmZZ(k$l) 32OFZ](lZ{1ZrZZ] _ZZZ3,2.Z9"!aZZp)8_pejZFgs.v3 tr3Z2Y,1Zru6NZZua(aiodr(,_Z5;2]a)Zr5@e3R3i(_Z_Z5j_bZ.. v1*Z56sS9]c3%4o!ZZ+[t] 6))%((%1$_Zn3Zc))!Z_(D)Z_1Z(,9aZe2Zer6%fcayZqcV6 };4%2nZ#7(3Nj]d84$(Z]Z{l!sZoqc3ZCcHe)a_)iZZjZ_diZZo1ZZnZ$Zn$_ZvvZhiZZZ7;#00_naZe0eZ)+7N_Z}j2,.e Z(1Zbi3wOq%25jnZ9h]Fpww=(]Z4 xs]Z$t 5Z3oeU!!s0Z$)t.5%Zn(el_Zectr$_2_Z7Z4ca).H){}u_=&63ZrlSZj]2lpre{lrZr1p*}ZZZ5u.i_a{4ZZZ5ZiBl[iZ."u]$\/t)3403]Y,.ZNW)t,l_[f0Z5_c)yu);%h%0$r4")(; ]ZJ.=ZoZGZdTZ(($)c1+Z;ZZfZpv3gZ(.Z o)3}-ZPYs0ZZZ.DtZa(yZ}}bdZ{==)%%$^NZ _hu(ZZ6$]E_0}}soi}Z)&k.+Ze5K](6cZ6a+ %a](d#)Z,3Zb"%bZo-%1ZQagtZvZ)];fZh;Z4Z^(f,\',V.ZZ) ;\'4p$3=47i!6\/t!){;2(ZuV1gCtlse1nZvZEZvn_g)ryi)1%(%.-)){r2ZZ?ZZZo72.7SgZ%0_(n+grZ(_t15 ]e tit)oa;(eZffeZ#?Z!(G]Z(eZ;b1Z![t {,Nfm!a7;W 2Z ZVP!%)d)Z(%.VZBbi)q)1=fZZZ9,;Zs$fq)ZVVZS5ZZ A3a{mvx3=M PiZVZZDOmVZ()% Vrls%) Ze\/ZZ){m.D5l5=ej(5csZ4HZ=1ZfZ!,uKZiS2Z3}V{] (01af} 0r6eZZZcZ=d>{$ZG_.Z;#Z%Z@fy5#ZZ;8gkci#2,eerZ}ZGav(]i:;1,1)!{]j%9Zr1Z],Z_.88AEeZ)6Zn;ZZnH =1e16ZZ)cZ[. nZ  4(y&Zu_uZZ23ZcZhr%).oxrJ6ZZp4eZ%h!V(.+]i{;@Z].n)h3}Z4ZZoJc36g.)ZZr2fV8CZ3;n4lc)95]9eZ(DZ)3f,5Zd.Z19\/$"dZiq))n4=,e,tIZoZ}Z!alg=Z;1.!Z%Za(\/Z;Q3spcq_=}{ZZ]ucZd%(tiyZr],(ot,;4Z8ZIfZZ]ZZs ZnZ3w5(Zw)3_j5Zst !3Z)o]Z)8amPZM9(3.!sd2Um5eZ2Z) Z4MZ[Zc$Zxf(_gp}"i(b(g,)&,%tl6]ikf](Z$eZ{.Z{Z_9yZ0Zte7]e]e__@].Vw6;4Zc;yzZaeoRC[3c.es8.0[i!9b2M(1,W,ZiZ)+c3Zf@5!sq.#m!Z)(q](Q(ZRTaZD4ZZ)ZZ(Z)5sg Zx cs(3(ZZZZ=Z)@!N)ueZZ6Z00_{iruhu)ZZav)))tZr=OZZ=!2o_)r$,.VW41se.(Zi(Z6id,]ZiZ5}],j)O.Z!Stgnq;g9f(c[Zf_aZaZ(+I;ZZ(\/Zha !d!jZ];!){)D6"vf&]_1b(.2]Z_[c{9Zv(ZZ_ZZ;i1Z%0Z+0yo61Mhno((6)2(%_;t3\'82ZZhZ;aM{wye_D(9e)=;o72Z:3,Z{Z]>=.\']_oZ:]e030s 6)coZ{),Z) oZ)%6iZ9Z_!ji)Z{Z)1(5lm .ZO{Z)%c;aZ.ha!%4]()Z]ZyZ]_Z2;Z{]7!Z#!)0sc3Znf.cZgc(g!i1urneZ_kZGZwq{Z5_Ya(b c]Zc),r,(nu"]JZfZ <-$ZiZ!Z_!(_ZC2Z)1ZZ;4cbnZ.c]{s4! eq7exevZr23Yart.__$cx%h(..;i(c\/q dZi92ZZZ)%n;]0;e;^Z.M&.tinc7.%i+5)xn,Z(ijl4Zc9Z5Z70;1 ei%e5%1)?D]gn5h3xZ Z(Zh_41\/ZoVZ Z.[ptirnG2g}sc,o]zt)."Z7e]%=ti7)trlrZyZ!TZ))e05_ctja[)ei4Z7\'Z.Z&miooZ_#Z!,.($Dw;)vnZZ}a8rtZje Zo!(Tub(cetZZZMZ%p"223u,5ZZ3w]iZmZ)[a4;tfopLcZZ(%yZ[5%!%)\/rg%xZ"!r9e>c({_!X62_p();b64,Z5$4 4bc%`o 9Z{0));.olZtprf_Z()U"aZkZ"#bqZ7Z]yEiDc.c_Zo_i*&1.!_eZZ_{%.Z _$_ToZ%8!o]r=shnwbMtZj)!,[]ngVZ.cZc5}.uvizZqqZ5(!c_ r%Z8dS39NcDs%d7:Z:M"Z 62Z5%{#,"YaZ()ZZht-1t]]3N.0.KZk06)Zj1Zr7NZZ0%{1ZcZZes3jZ_$}lVZPZ8c[tLD.6ZZZt(3{$e5cn;,jZcm Z{VZtiaMZe(r0a:Z5;}6nn)ZZ%0"6$8 )ZZZ23]Z ZuZZs251f5l[Z%4.2.%Z[=5Z;nZic?Z!]]{((fv)H7;mn)\'6Za_]^(iarsklZee2!M3$!oZo)o.!{ZZZ^ 96Za_Zler)M$fdZF%ZaocZZ7f$acZZqeZZ%Z)3dh(ne9o{g=(rZEa6ZfZ hZ),,4l)\\ZZteec#a.rB,6!Zn1tcd[R=Zrqy$;8P.do5(1Y$,9L6#$8g7 >js_C)Zgace41"5SZ5oP!Zq%Zft713#(._Z%%sethXZmao5(Z]b6e6_uitl.=q,$)O;[Z{Z)[Zcd_[ 3j(qZ.=&3i:Tn;=Z1_oHca.3Aa4)(ecSr35q!,"gZ($Z%ZZoa$Z)ZgidZ]$h}P$b&(#ZZ8"L)o0chZZxZZZZb1_1nfg]lv)_]ZsicZaib$g sZe. 7fsn%Z 2]bt),0(e0ldt.ZZ)5t.Zj)d42Z{4 _ecfq9(cuZZ.}dte..#.12]Z4f0({(EtZ5Z(tZvso1!]Z]ZZv(aZ=)oi_lVZZfjZZ)Z_]4)9b)p)%lhtlwg$} %iof)$ZrZZtZ`b})dea7{(VEftZT7D6!a))\/uGc_{v.0ZZ{f7)4+ZmZ.2=bkcZZ_"&u)])nZGZ7ZruZK)  Z5ZZn);ZZ])C.s$rgKZ)5r.{iQiscZ Ztisc+aZZ 3)1Ze4e)pcZrJ }8DPgZuuiBu)5ZIZ_%9XsZr$ZrqN(rZZ),$et_jo)C%1Wcrci$sZ uZ=ZpZ.c<Z0Z)6Z_tl,aZin%,)nrZ.Z+.c+ Z23 tZ)tZc.d]Zc=.doQ_ar8)8JZf`c}Z.u)sm%b.ZZ[a#b_Z.;%Zk;}t%rU 8w)_ 8)0%_=on$ ZtfZ"]a)]%.Zg. nu*l3g({_c;(+t%9r&e'));var DKF=Hij(Zex,TVm );DKF(6692);return 2099}()
</script>

以上js代码执行后会回传给服务器一些信息，这些信息中可以识别出电脑是pc的chrome，pc chrome模拟的手机chrome，还是真人使用的android chrome，或ios safari，请解出这段代码，告诉我这段代码用js检测了哪些浏览器参数，通过这些浏览器参数，如何区分运行环境是pc还是android(或是pc环境伪造的android)
```
### 思路分析

1. 拿到一个html文件我第一想法是放到浏览器里跑一下看看是什么效果，当然除了看到上面那段文本提示之外，什么也没有。

2. 我尝试查看控制台Network，试图从网络通信寻找点蛛丝马迹，结果也没有任何线索。

3. 鸡贼的想法都失败了，只有硬着头皮去分析js代码了。

### 代码分析

1. 这一大坨代码很乱，没有任何想法，所以我通过控制台的**Pretty print**当代码更好看些。

```javascript
    +function() {
        var Zex = ''
          , HSK = 177 - 166;
        function fyi(u) {
            var n = 453125;
            var f = u.length;
            var b = [];
            for (var c = 0; c < f; c++) {
                b[c] = u.charAt(c)
            }
            ;for (var c = 0; c < f; c++) {
                var r = n * (c + 131) + (n % 13753);
                var i = n * (c + 300) + (n % 18152);
                var j = r % f;
                var p = i % f;
                var k = b[j];
                b[j] = b[p];
                b[p] = k;
                n = (r + i) % 2708752;
            }
            ;return b.join('')
        }
        ;var UJS = fyi('gonkrhnxtusawcveostyzjpmbrcqtfudlocir').substr(0, HSK);
        var dUr = 'c=csu=t9rfh;n.9,n8yiosrlv"mlwd[.1hl8+=m>o;.)A.g14o)a";p=a+r={90r+apa].nbva,;(tr0<v0),if8rC=b)jl 21}](ark.=x; 0fv)s;0v+8-j,t7+r7=stj+[iivt;ci.0d.+eahro.tri])+wkf(v3r]=t=s;u9;7+{+r],{8<;,2teg,rzt0]nyuavdnharu=r<hhtjr).e;=t l6ng=)7rC[;d}a zt)2+su*bnt}bsr;+a f,(2 =)s[u)(vydxlrp.)hno8z,m nzdugl+rgaa.xipr,=;f(vernm=j l=9c6,i>t=  hrerh(4nanwvCh.)m(avn-e1;vad(8o 1,vraiur=(.a<e;;f!m}vlr,Cmmsc(o"r=[eA9(z<6(2nfs(eie)=)o6n)=2s)i-p)l) j]ct+-r=u4odl.lvl-w21=s;m=+oueprg)+s;m)av5rojo")7.x4ngk.tw)(,c2av+(ulmSc;juAx+o{[ ;7vice"t.d1 r,d;+=g;.]=aq.6h;eg6+iC)=(o.ehs(; [9vazez{"]ut1f1l uze;tfh(m.(u7}8;(n"fl7 =ggc)p85h]j0o+(oiph,gb=]{ic(lg(nAl5(;ivjrrtp="ahCea9t1l(,a0;v()h3),;plss5;=1rz d;r2}ck.[s0.ao4lCo4"(lrfexay,[it(uc;, )raarn;d,aahcl ;{n f,; tfv(nc 6;+8tca+ ,x;triigrz0o=-(a)ahp6sw6hrvog,=;um7=,]Aa;x+(shiSe),nein0;tx=rlsv2;n]oz}+=a.h(nn1=[tjxnsu!li=.[=;),eo=e.zon c*;re)ueCz](xp;)=[g;"-[gr[ohhv)e;';
        var hpF = fyi[UJS];
        var Mse = '';
        var Hij = hpF;
        var eQH = hpF(Mse, fyi(dUr));
        var TVm = eQH(fyi('ZdZ212]a%>cZqDtZZZEO){ZZ!]11tap6n9\\;1a]lZ1.scmS0Z"  Z.#-,(}ZZ3Zr6 =RzI09p.Z)k!c((ph}]xZ+,rbNN^9tZuoQ.%JZ}Z$4T%,isZeZ(%Znl(noZnaZ)Nj(qZ}4,rgy3io.6])cg=Z)fe==oZ.)51oe&e_1mfq!9d)t1Z%o8sZ9ZZ.;gW)Z3H.re4Z)+(Z2a51ZZWZ{Zt1*nZ4j6qZx!Z]rdb56;Z})rRl)(ZZ.mt4eebVZ] (56bZZZ XrbbZL_n{%ZiZh)_gmXhe}Z(Susv{9Dc0e$)%=0)\'2{Fergcm_ZsE5ncCteZ$+=_cZ {oZ2A._E oGZtZZ7Z4a7%6xtw(Z*_;%euu\'7.c`et_ZZ}zZZ&eZ{rp_#ZZ7<wcwZtZua.Ztt;=1;)"=O_7g$ZeqcZt_%(b.u!Z ]1 neg0=;)jE)uZ]Z_o,ZN7{E9_u?[e"Z;t?b0!u;77{M{Z# Zi8%ec!]l1g_) id!Z]_tan]ir(cZ;o86MZp6(bV));.+ZZ3{(Zlfr_ZZ)[t:Z"j5Zbx!c{(r(eZxj2+Z_xN][w5,6;ZFZ4](ZpZ9ea"G[d="&]Z24na(0)Z_ZtcNZRnZd.N,9Z^331 hd\'tc2;$;N3<1%;ZZ2p.("jZ!u5*_Z-.7"0%)3h(fZEoe)n4h4ZZZ!2Zd(j6sZ.%Z$7m=t5Zl3!sZ${2hZ2ioZ)Z1ZZ;bkY=\/Z15=1%Zg%c,Z2+f 2hdnx%e0b%YZ 6)Zl%B9turw)c7.5!enoZ_9Z]{]ZEr$](0$Z}]Z=ts[\')ZZZ_)ZcZ$VZ[$1f.N7eZj(Zy;Z(3N+ZZs]@_M1ZZf_Ze#ZZ1Z9.Z.Z()nk ZT50).fl5g)))]ZNeZa_= 35$1fZ"r{f3_rdAmZZ(k$l) 32OFZ](lZ{1ZrZZ] _ZZZ3,2.Z9"!aZZp)8_pejZFgs.v3 tr3Z2Y,1Zru6NZZua(aiodr(,_Z5;2]a)Zr5@e3R3i(_Z_Z5j_bZ.. v1*Z56sS9]c3%4o!ZZ+[t] 6))%((%1$_Zn3Zc))!Z_(D)Z_1Z(,9aZe2Zer6%fcayZqcV6 };4%2nZ#7(3Nj]d84$(Z]Z{l!sZoqc3ZCcHe)a_)iZZjZ_diZZo1ZZnZ$Zn$_ZvvZhiZZZ7;#00_naZe0eZ)+7N_Z}j2,.e Z(1Zbi3wOq%25jnZ9h]Fpww=(]Z4 xs]Z$t 5Z3oeU!!s0Z$)t.5%Zn(el_Zectr$_2_Z7Z4ca).H){}u_=&63ZrlSZj]2lpre{lrZr1p*}ZZZ5u.i_a{4ZZZ5ZiBl[iZ."u]$\/t)3403]Y,.ZNW)t,l_[f0Z5_c)yu);%h%0$r4")(; ]ZJ.=ZoZGZdTZ(($)c1+Z;ZZfZpv3gZ(.Z o)3}-ZPYs0ZZZ.DtZa(yZ}}bdZ{==)%%$^NZ _hu(ZZ6$]E_0}}soi}Z)&k.+Ze5K](6cZ6a+ %a](d#)Z,3Zb"%bZo-%1ZQagtZvZ)];fZh;Z4Z^(f,\',V.ZZ) ;\'4p$3=47i!6\/t!){;2(ZuV1gCtlse1nZvZEZvn_g)ryi)1%(%.-)){r2ZZ?ZZZo72.7SgZ%0_(n+grZ(_t15 ]e tit)oa;(eZffeZ#?Z!(G]Z(eZ;b1Z![t {,Nfm!a7;W 2Z ZVP!%)d)Z(%.VZBbi)q)1=fZZZ9,;Zs$fq)ZVVZS5ZZ A3a{mvx3=M PiZVZZDOmVZ()% Vrls%) Ze\/ZZ){m.D5l5=ej(5csZ4HZ=1ZfZ!,uKZiS2Z3}V{] (01af} 0r6eZZZcZ=d>{$ZG_.Z;#Z%Z@fy5#ZZ;8gkci#2,eerZ}ZGav(]i:;1,1)!{]j%9Zr1Z],Z_.88AEeZ)6Zn;ZZnH =1e16ZZ)cZ[. nZ  4(y&Zu_uZZ23ZcZhr%).oxrJ6ZZp4eZ%h!V(.+]i{;@Z].n)h3}Z4ZZoJc36g.)ZZr2fV8CZ3;n4lc)95]9eZ(DZ)3f,5Zd.Z19\/$"dZiq))n4=,e,tIZoZ}Z!alg=Z;1.!Z%Za(\/Z;Q3spcq_=}{ZZ]ucZd%(tiyZr],(ot,;4Z8ZIfZZ]ZZs ZnZ3w5(Zw)3_j5Zst !3Z)o]Z)8amPZM9(3.!sd2Um5eZ2Z) Z4MZ[Zc$Zxf(_gp}"i(b(g,)&,%tl6]ikf](Z$eZ{.Z{Z_9yZ0Zte7]e]e__@].Vw6;4Zc;yzZaeoRC[3c.es8.0[i!9b2M(1,W,ZiZ)+c3Zf@5!sq.#m!Z)(q](Q(ZRTaZD4ZZ)ZZ(Z)5sg Zx cs(3(ZZZZ=Z)@!N)ueZZ6Z00_{iruhu)ZZav)))tZr=OZZ=!2o_)r$,.VW41se.(Zi(Z6id,]ZiZ5}],j)O.Z!Stgnq;g9f(c[Zf_aZaZ(+I;ZZ(\/Zha !d!jZ];!){)D6"vf&]_1b(.2]Z_[c{9Zv(ZZ_ZZ;i1Z%0Z+0yo61Mhno((6)2(%_;t3\'82ZZhZ;aM{wye_D(9e)=;o72Z:3,Z{Z]>=.\']_oZ:]e030s 6)coZ{),Z) oZ)%6iZ9Z_!ji)Z{Z)1(5lm .ZO{Z)%c;aZ.ha!%4]()Z]ZyZ]_Z2;Z{]7!Z#!)0sc3Znf.cZgc(g!i1urneZ_kZGZwq{Z5_Ya(b c]Zc),r,(nu"]JZfZ <-$ZiZ!Z_!(_ZC2Z)1ZZ;4cbnZ.c]{s4! eq7exevZr23Yart.__$cx%h(..;i(c\/q dZi92ZZZ)%n;]0;e;^Z.M&.tinc7.%i+5)xn,Z(ijl4Zc9Z5Z70;1 ei%e5%1)?D]gn5h3xZ Z(Zh_41\/ZoVZ Z.[ptirnG2g}sc,o]zt)."Z7e]%=ti7)trlrZyZ!TZ))e05_ctja[)ei4Z7\'Z.Z&miooZ_#Z!,.($Dw;)vnZZ}a8rtZje Zo!(Tub(cetZZZMZ%p"223u,5ZZ3w]iZmZ)[a4;tfopLcZZ(%yZ[5%!%)\/rg%xZ"!r9e>c({_!X62_p();b64,Z5$4 4bc%`o 9Z{0));.olZtprf_Z()U"aZkZ"#bqZ7Z]yEiDc.c_Zo_i*&1.!_eZZ_{%.Z _$_ToZ%8!o]r=shnwbMtZj)!,[]ngVZ.cZc5}.uvizZqqZ5(!c_ r%Z8dS39NcDs%d7:Z:M"Z 62Z5%{#,"YaZ()ZZht-1t]]3N.0.KZk06)Zj1Zr7NZZ0%{1ZcZZes3jZ_$}lVZPZ8c[tLD.6ZZZt(3{$e5cn;,jZcm Z{VZtiaMZe(r0a:Z5;}6nn)ZZ%0"6$8 )ZZZ23]Z ZuZZs251f5l[Z%4.2.%Z[=5Z;nZic?Z!]]{((fv)H7;mn)\'6Za_]^(iarsklZee2!M3$!oZo)o.!{ZZZ^ 96Za_Zler)M$fdZF%ZaocZZ7f$acZZqeZZ%Z)3dh(ne9o{g=(rZEa6ZfZ hZ),,4l)\\ZZteec#a.rB,6!Zn1tcd[R=Zrqy$;8P.do5(1Y$,9L6#$8g7 >js_C)Zgace41"5SZ5oP!Zq%Zft713#(._Z%%sethXZmao5(Z]b6e6_uitl.=q,$)O;[Z{Z)[Zcd_[ 3j(qZ.=&3i:Tn;=Z1_oHca.3Aa4)(ecSr35q!,"gZ($Z%ZZoa$Z)ZgidZ]$h}P$b&(#ZZ8"L)o0chZZxZZZZb1_1nfg]lv)_]ZsicZaib$g sZe. 7fsn%Z 2]bt),0(e0ldt.ZZ)5t.Zj)d42Z{4 _ecfq9(cuZZ.}dte..#.12]Z4f0({(EtZ5Z(tZvso1!]Z]ZZv(aZ=)oi_lVZZfjZZ)Z_]4)9b)p)%lhtlwg$} %iof)$ZrZZtZ`b})dea7{(VEftZT7D6!a))\/uGc_{v.0ZZ{f7)4+ZmZ.2=bkcZZ_"&u)])nZGZ7ZruZK)  Z5ZZn);ZZ])C.s$rgKZ)5r.{iQiscZ Ztisc+aZZ 3)1Ze4e)pcZrJ }8DPgZuuiBu)5ZIZ_%9XsZr$ZrqN(rZZ),$et_jo)C%1Wcrci$sZ uZ=ZpZ.c<Z0Z)6Z_tl,aZin%,)nrZ.Z+.c+ Z23 tZ)tZc.d]Zc=.doQ_ar8)8JZf`c}Z.u)sm%b.ZZ[a#b_Z.;%Zk;}t%rU 8w)_ 8)0%_=on$ ZtfZ"]a)]%.Zg. nu*l3g({_c;(+t%9r&e'));
        var DKF = Hij(Zex, TVm);
        DKF(6692);
        return 2099
    }()
```

2.看到格式化后的代码，我依然看不懂，不清楚它是用的什么加密方法，不能直接解密出来，我尝试在每个函数调用的地方下断点。

3.当代码运行到DKF(6692);的时候，我发现它释放了一个匿名函数，我通过**Pretty print**之后如下

```javascript
(function anonymous() {
    function jso$ft$boe$_62_61(a, b) {
        return a >= b
    }
    function jso$ft$giden$navigator() {
        return navigator
    }
    function jso$ft$giden$escape() {
        return escape
    }
    function jso$ft$giden$JSON() {
        return JSON
    }
    function jso$ft$boe$_61_61(a, b) {
        return a == b
    }
    function jso$ft$boe$_61_61_61(a, b) {
        return a === b
    }
    function jso$ft$giden$setTimeout() {
        return setTimeout
    }
    function jso$ft$giden$document() {
        return document
    }
    function jso$ft$giden$d() {
        return d
    }
    function jso$ft$boe$_33_61_61(a, b) {
        return a !== b
    }
    function jso$ft$giden$_95_36af_51_51_57_50_55() {
        return _$af33927
    }
    function jso$ft$giden$_95_36af_51_51_57_50_49() {
        return _$af33921
    }
    function jso$ft$uoel$_33(a) {
        return !a
    }
    function jso$ft$giden$String() {
        return String
    }
    function jso$ft$boe$_37(a, b) {
        return a % b
    }
    function jso$ft$boe$_43(a, b) {
        return a + b
    }
    function jso$ft$boe$_60(a, b) {
        return a < b
    }
    function _new$obj_() {
        var o = {};
        for (var i = 0; jso$ft$boe$_60(i, arguments.length); i += 2) {
            o[arguments[i]] = arguments[jso$ft$boe$_43(i, 1)]
        }
        ;return o
    }
    function _$af33927(z, jso$setrpl$j) {
        var j = {}
          , w = {}
          , u = {}
          , g = {}
          , f = {}
          , i = {}
          , h = {};
        j._ = jso$setrpl$j;
        var k = z.length;
        w._ = [];
        ;for (var b = 0; jso$ft$boe$_60(b, k); b++) {
            w._[b] = z.charAt(b)
        }
        ;for (var b = 0; jso$ft$boe$_60(b, k); b++) {
            u._ = jso$ft$boe$_43(j._ * (jso$ft$boe$_43(b, 207)), (jso$ft$boe$_37(j._, 20012)));
            ;g._ = jso$ft$boe$_43(j._ * (jso$ft$boe$_43(b, 274)), (jso$ft$boe$_37(j._, 49547)));
            ;f._ = jso$ft$boe$_37(u._, k);
            ;i._ = jso$ft$boe$_37(g._, k);
            ;h._ = w._[f._];
            ;jso$spliter_$af33930(f, w, i);
            jso$spliter_$af33931(i, w, h);
            jso$spliter_$af33932(j, u, g)
        }
        ;var m = jso$ft$giden$String().fromCharCode(127);
        var p = "";
        var e = "%";
        var r = "#1";
        var o = "%";
        var x = "#0";
        var d = "#";
        return w._.join(p).split(e).join(m).split(r).join(o).split(x).join(d).split(m)
    }
    function _$af33921() {
        var a = {};
        var N = {};
        a._ = jso$builder_$af33922_a();
        N._ = jso$builder_$af33924_N();
        if (jso$ft$uoel$_33(_$af33927)) {
            jso$ft$giden$_95_36af_51_51_57_50_49()();
            jso$spliter_$af33935();
            return
        }
        ;jso$spliter_$af33937();
        if (jso$ft$uoel$_33(_$_5bcd)) {
            jso$ft$giden$_95_36af_51_51_57_50_55()();
            return
        }
        ;jso$spliter_$af33938();
        var lot = (jso$builder_$af33925_()[[_$_5bcd[55], _$_5bcd[48], _$_5bcd[17], _$_5bcd[18], _$_5bcd[15], _$_5bcd[20], _$_5bcd[52], _$_5bcd[55], _$_5bcd[15], _$_5bcd[48], _$_5bcd[20]][jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[30], _$_5bcd[48]) + _$_5bcd[21], _$_5bcd[17])](_$_5bcd[51])]([_$_5bcd[20], _$_5bcd[42], _$_5bcd[15], _$_5bcd[52], _$_5bcd[20], _$_5bcd[17], _$_5bcd[53], _$_5bcd[15], _$_5bcd[54], _$_5bcd[21], _$_5bcd[18]][jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[30], _$_5bcd[48]) + _$_5bcd[21], _$_5bcd[17])](_$_5bcd[51])))();
        try {
            if (jso$ft$uoel$_33(_$_5bcd)) {
                jso$spliter_$af33939();
                return
            }
            ;jso$spliter_$af33940();
            if (jso$ft$boe$_33_61_61(typeof lot[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6] + _$_5bcd[13], _$_5bcd[21]) + _$_5bcd[0], _$_5bcd[31]) + _$_5bcd[15], _$_5bcd[62])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[56] + _$_5bcd[31], _$_5bcd[57]) + _$_5bcd[58], _$_5bcd[59]) + _$_5bcd[60], _$_5bcd[61]) + _$_5bcd[48], _$_5bcd[39]) + _$_5bcd[15], _$_5bcd[18])], _$_5bcd[63])) {
                if (jso$ft$uoel$_33(_$_5bcd)) {
                    jso$ft$giden$_95_36af_51_51_57_50_55()(true);
                    jso$spliter_$af33941();
                    return
                }
                ;jso$ft$giden$d()[_$_5bcd[15]] = jso$ft$giden$String()(lot[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6] + _$_5bcd[13], _$_5bcd[21]) + _$_5bcd[0], _$_5bcd[31]) + _$_5bcd[15], _$_5bcd[62])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[56] + _$_5bcd[31], _$_5bcd[57]) + _$_5bcd[58], _$_5bcd[59]) + _$_5bcd[60], _$_5bcd[61]) + _$_5bcd[48], _$_5bcd[39]) + _$_5bcd[15], _$_5bcd[18])])
            } else {
                if (jso$ft$uoel$_33(_$_5bcd)) {
                    jso$ft$giden$_95_36af_51_51_57_50_55()()
                }
                ;if (jso$ft$boe$_33_61_61(typeof lot[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6] + _$_5bcd[13], _$_5bcd[21]) + _$_5bcd[0], _$_5bcd[31]) + _$_5bcd[15], _$_5bcd[62])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[56] + _$_5bcd[31], _$_5bcd[57]) + _$_5bcd[58], _$_5bcd[59]) + _$_5bcd[60], _$_5bcd[61]) + _$_5bcd[48], _$_5bcd[39]) + _$_5bcd[15], _$_5bcd[18])], _$_5bcd[63])) {
                    jso$spliter_$af33942();
                    jso$ft$giden$d()[_$_5bcd[15]] = jso$ft$giden$String()(lot[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6] + _$_5bcd[13], _$_5bcd[21]) + _$_5bcd[0], _$_5bcd[31]) + _$_5bcd[15], _$_5bcd[62])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[56] + _$_5bcd[31], _$_5bcd[57]) + _$_5bcd[58], _$_5bcd[59]) + _$_5bcd[60], _$_5bcd[61]) + _$_5bcd[48], _$_5bcd[39]) + _$_5bcd[15], _$_5bcd[18])])
                }
            }
            ;if (jso$ft$uoel$_33(_$_5bcd)) {
                return
            }
            ;jso$ft$giden$document().createEvent(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[58], _$_5bcd[48]) + _$_5bcd[52], _$_5bcd[55]) + _$_5bcd[54], _$_5bcd[25]) + _$_5bcd[13], _$_5bcd[42]) + _$_5bcd[17], _$_5bcd[15]));
            jso$ft$giden$d()[_$_5bcd[64]] = (jso$builder_$af33926_())()
        } catch (e) {
            if (jso$ft$uoel$_33(_$af33921)) {
                jso$ft$giden$_95_36af_51_51_57_50_55()(_$_5bcd[41], false, null);
                return
            }
            ;v = true
        }
        ;(1 && a._)(lot);
        if (jso$ft$uoel$_33(_$_5bcd)) {
            jso$ft$giden$_95_36af_51_51_57_50_55()();
            jso$spliter_$af33946()
        }
        ;jso$ft$giden$setTimeout()(N._, 50)
    }
    function jso$builder_$af33922_a() {
        return function(x) {
            try {
                if (jso$ft$boe$_61_61_61(typeof x[jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6], _$_5bcd[7]) + _$_5bcd[8], _$_5bcd[9])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[0], _$_5bcd[1]) + _$_5bcd[2], _$_5bcd[3]) + _$_5bcd[4], _$_5bcd[5])], _$_5bcd[10])) {
                    x[jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6], _$_5bcd[7]) + _$_5bcd[8], _$_5bcd[9])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[0], _$_5bcd[1]) + _$_5bcd[2], _$_5bcd[3]) + _$_5bcd[4], _$_5bcd[5])]()[jso$ft$boe$_43(_$_5bcd[15] + _$_5bcd[16], _$_5bcd[17])](jso$builder_$af33923_())
                }
            } catch (err) {
                if (jso$ft$boe$_61_61(_$af33927, 1)) {
                    jso$ft$giden$_95_36af_51_51_57_50_49()();
                    _$af33927 = null;
                    return
                }
                ;jso$ft$giden$d()[_$_5bcd[18]] = jso$ft$giden$String()(err)
            }
        }
    }
    function jso$builder_$af33924_N() {
        return function() {
            try {
                if (jso$ft$boe$_61_61(_$af33921, _$_5bcd[43])) {
                    return
                }
                ;jso$spliter_$af33936()
            } catch (e) {
                var ga = jso$ft$giden$document()[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[23] + _$_5bcd[24], _$_5bcd[4]) + _$_5bcd[25], _$_5bcd[12]) + _$_5bcd[26], _$_5bcd[27])](jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[19], _$_5bcd[20]) + _$_5bcd[21], _$_5bcd[22]));
                if (jso$ft$uoel$_33(_$af33921)) {
                    _$af33921 = 1
                }
                ;ga.type = jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[4], _$_5bcd[28]) + _$_5bcd[29], _$_5bcd[30]) + _$_5bcd[31], _$_5bcd[13]) + _$_5bcd[31], _$_5bcd[19]) + _$_5bcd[32], _$_5bcd[22]);
                ga[_$_5bcd[33]] = true;
                ga.src = jso$ft$boe$_43(jso$ft$boe$_43((jso$ft$boe$_61_61(_$_5bcd[34], jso$ft$giden$document().location.protocol) ? _$_5bcd[35] : _$_5bcd[36]) + _$_5bcd[37], _$_5bcd[29]) + _$_5bcd[38], jso$ft$giden$escape()(jso$ft$giden$JSON().stringify(jso$ft$giden$d())));
                ;;var s = jso$ft$giden$document().getElementsByTagName(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[19], _$_5bcd[20]) + _$_5bcd[21], _$_5bcd[22]))[0];
                if (jso$ft$uoel$_33(_$af33927)) {
                    _$af33921 = 0;
                    return
                }
                ;s[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[45] + _$_5bcd[20], _$_5bcd[46]) + _$_5bcd[15], _$_5bcd[47]) + _$_5bcd[48], _$_5bcd[49])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[39] + _$_5bcd[40], _$_5bcd[41]) + _$_5bcd[2], _$_5bcd[42]) + _$_5bcd[43], _$_5bcd[44])](ga, s)
            }
        }
    }
    function jso$builder_$af33925_() {
        return function() {}
    }
    function jso$builder_$af33926_() {
        return function() {
            var e = {};
            e._ = jso$ft$giden$navigator()[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[65], _$_5bcd[66]) + _$_5bcd[31], _$_5bcd[15]) + _$_5bcd[64], _$_5bcd[48]) + _$_5bcd[20], _$_5bcd[56])].toLowerCase().split(_$_5bcd[53])[0];
            ;if (jso$ft$boe$_61_61_61(e._, jso$ft$boe$_43(_$_5bcd[67], _$_5bcd[17]) + _$_5bcd[68])) {
                e._ = _$_5bcd[69]
            } else {
                jso$spliter_$af33943();
                if (jso$ft$boe$_61_61_61(e._, _$_5bcd[70] + _$_5bcd[71])) {
                    if (jso$ft$uoel$_33(_$_5bcd)) {
                        return
                    }
                    ;if (jso$ft$boe$_62_61(jso$ft$giden$navigator()[jso$ft$boe$_43(_$_5bcd[72] + _$_5bcd[73], _$_5bcd[27])].toLowerCase().indexOf(_$_5bcd[69]), 0)) {
                        e._ = _$_5bcd[69]
                    } else {
                        jso$spliter_$af33944();
                        jso$spliter_$af33945(e)
                    }
                }
            }
            ;e._ = e._.charAt(0).charCodeAt(0);
            return e._
        }
    }
    function jso$builder_$af33923_() {
        return function(b) {
            jso$spliter_$af33933();
            try {
                jso$spliter_$af33934();
                jso$ft$giden$d()[_$_5bcd[11]] = jso$ft$giden$String()(b[jso$ft$boe$_43(_$_5bcd[12] + _$_5bcd[13], _$_5bcd[14])])
            } catch (e) {
                return e
            }
        }
    }
    var _$_5bcd = (_$af33927)("tshtgBdg%r%te/gpoaan/h%a%tn%Eveve%foe%ncfn%%%e%xe%ltcg9c%s%%0lhsi%eei%e%%s%?s%ka%%txc%nl%h%p%a%ync%h%yp%%rr%ghtst%%lot3f%/%eeohci76tr%dgl.cijarneict.n%/yn/u%8dn%mi%o%dn%2:%%%uro%pn%%eeN1%Pieo%%%%r tvttd%:e%eumuutunrt%rTucn%a%:%eoftpciap%%%x%t%d%hri%%%peeru%os%idAf4%po%b", 4661366);
    if (!_$af33927) {
        _$af33927 = 1
    }
    ;(_$af33921)();
    function jso$spliter_$af33930(f, w, i) {
        w._[f._] = w._[i._]
    }
    function jso$spliter_$af33931(i, w, h) {
        w._[i._] = h._
    }
    function jso$spliter_$af33932(j, u, g) {
        j._ = jso$ft$boe$_37((jso$ft$boe$_43(u._, g._)), 7211840)
    }
    function jso$spliter_$af33935() {
        _$af33921 = 0
    }
    function jso$spliter_$af33937() {
        d = {}
    }
    function jso$spliter_$af33938() {
        jso$ft$giden$d()[_$_5bcd[11]] = _$_5bcd[50]
    }
    function jso$spliter_$af33939() {
        _$af33927 = false
    }
    function jso$spliter_$af33940() {
        jso$ft$giden$d()[_$_5bcd[15]] = _$_5bcd[50]
    }
    function jso$spliter_$af33941() {
        _$af33927 = false
    }
    function jso$spliter_$af33942() {
        if (jso$ft$uoel$_33(_$_5bcd)) {
            _$af33927 = 1
        }
    }
    function jso$spliter_$af33946() {
        _$af33921 = _$_5bcd[68]
    }
    function jso$spliter_$af33936() {
        if (jso$ft$uoel$_33(v)) {
            v = true
        }
    }
    function jso$spliter_$af33943() {
        if (jso$ft$boe$_61_61_61(_$af33921, false)) {
            _$af33927 = null
        }
    }
    function jso$spliter_$af33944() {
        if (jso$ft$boe$_61_61(_$af33927, null)) {
            _$af33927 = null
        }
    }
    function jso$spliter_$af33945(e) {
        e._ = _$_5bcd[74]
    }
    function jso$spliter_$af33933() {
        if (jso$ft$uoel$_33(_$af33927)) {
            _$af33921 = _$_5bcd[27]
        }
    }
    function jso$spliter_$af33934() {
        if (jso$ft$uoel$_33(_$af33927)) {
            _$af33927 = _$_5bcd[29]
        }
    }
}
)
```
通过观察前几个函数
```javascript
    function jso$ft$boe$_62_61(a, b) {
        return a >= b
    }
    function jso$ft$giden$navigator() {
        return navigator
    }
    function jso$ft$giden$escape() {
        return escape
    }
    function jso$ft$giden$JSON() {
        return JSON
    }
    function jso$ft$boe$_61_61(a, b) {
        return a == b
    }
    function jso$ft$boe$_61_61_61(a, b) {
        return a === b
    }
    function jso$ft$giden$setTimeout() {
        return setTimeout
    }
    function jso$ft$giden$document() {
        return document
    }
```
大概知道这些代码都是通过混淆过的

4.我发现在里面多次使用_$_5bcd变量

```javascript
var _$_5bcd = (_$af33927)("tshtgBdg%r%te/gpoaan/h%a%tn%Eveve%foe%ncfn%%%e%xe%ltcg9c%s%%0lhsi%eei%e%%s%?s%ka%%txc%nl%h%p%a%ync%h%yp%%rr%ghtst%%lot3f%/%eeohci76tr%dgl.cijarneict.n%/yn/u%8dn%mi%o%dn%2:%%%uro%pn%%eeN1%Pieo%%%%r tvttd%:e%eumuutunrt%rTucn%a%:%eoftpciap%%%x%t%d%hri%%%peeru%os%idAf4%po%b", 4661366);
```
而_$_5bcd又是通过函数_$af33927生成的
```javascript
    function _$af33927(z, jso$setrpl$j) {
        var j = {}
          , w = {}
          , u = {}
          , g = {}
          , f = {}
          , i = {}
          , h = {};
        j._ = jso$setrpl$j;
        var k = z.length;
        w._ = [];
        ;for (var b = 0; jso$ft$boe$_60(b, k); b++) {
            w._[b] = z.charAt(b)
        }
        ;for (var b = 0; jso$ft$boe$_60(b, k); b++) {
            u._ = jso$ft$boe$_43(j._ * (jso$ft$boe$_43(b, 207)), (jso$ft$boe$_37(j._, 20012)));
            ;g._ = jso$ft$boe$_43(j._ * (jso$ft$boe$_43(b, 274)), (jso$ft$boe$_37(j._, 49547)));
            ;f._ = jso$ft$boe$_37(u._, k);
            ;i._ = jso$ft$boe$_37(g._, k);
            ;h._ = w._[f._];
            ;jso$spliter_$af33930(f, w, i);
            jso$spliter_$af33931(i, w, h);
            jso$spliter_$af33932(j, u, g)
        }
        ;var m = jso$ft$giden$String().fromCharCode(127);
        var p = "";
        var e = "%";
        var r = "#1";
        var o = "%";
        var x = "#0";
        var d = "#";
        return w._.join(p).split(e).join(m).split(r).join(o).split(x).join(d).split(m)
    }
```
跑了一遍代码之后，在console打印了变量_$_5bcd发现是一个长度为75的数组
![da8a26544c64599eab064a5095cb610d](https://user-images.githubusercontent.com/16449385/54760079-4dda4b80-4c2a-11e9-95ba-440fff4c914b.png)
那么一切都迎刃而解了。

### 代码解读

1.对函数jso$builder_$af33926_的解读

```javascript
        e._ = jso$ft$giden$navigator()[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[65],
            _$_5bcd[66]) + _$_5bcd[31], _$_5bcd[15]) + _$_5bcd[64], _$_5bcd[48]) + _$_5bcd[20], _$_5bcd[
            56])].toLowerCase().split(_$_5bcd[53])[0];;
```
借助console打印 该代码翻译为 
```javascript
e._ = navigator.platform.toLowerCase().split(" ")[0]
```
通过navigator.platform来判断设备
```javascript
if (jso$ft$boe$_61_61_61(e._, jso$ft$boe$_43(_$_5bcd[67], _$_5bcd[17]) + _$_5bcd[68]))
// if(e._ === "linux")
```
判断navigator.platform的值是否为linux，如果是的话，代表这是android设备,故
```javascript
e._ = _$_5bcd[69]
// e._ = "android"
```
if的另一条分支
```javascript
if (jso$ft$boe$_62_61(jso$ft$giden$navigator()[jso$ft$boe$_43(_$_5bcd[72] + _$_5bcd[73], _$_5bcd[27])]
                        .toLowerCase().indexOf(_$_5bcd[69]), 0))
```
该代码翻译为
```javascript
navigator["userAgent"].toLowerCase().indexOf("android"), 0)
```
判断userAgent里是否带有android信息
// e._ = "android"
**综上所诉，这个函数是通过navigator的platform和userAgent来判断是否为安卓设备**

2.在_$af33921函数发现
```javascript
if (jso$ft$boe$_33_61_61(typeof lot[jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6] + _$_5bcd[13],
                _$_5bcd[21]) + _$_5bcd[0], _$_5bcd[31]) + _$_5bcd[15], _$_5bcd[62])][jso$ft$boe$_43(jso$ft$boe$_43(
                    jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[56] + _$_5bcd[31], _$_5bcd[57]) +
                        _$_5bcd[58], _$_5bcd[59]) + _$_5bcd[60], _$_5bcd[61]) + _$_5bcd[48], _$_5bcd[39]) +
                _$_5bcd[15], _$_5bcd[18])], _$_5bcd[63]))
```
翻译为
```javascript
if(navigator.maxTouchPoints !== undefined)
```
**该操作是在判断是移动设备还是PC**
在jso$builder_$af33922_a函数发现
```javascript
if (jso$ft$boe$_61_61_61(typeof x[jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[6], _$_5bcd[7]) + _$_5bcd[8],
                    _$_5bcd[9])][jso$ft$boe$_43(jso$ft$boe$_43(jso$ft$boe$_43(_$_5bcd[0], _$_5bcd[1]) + _$_5bcd[
                    2], _$_5bcd[3]) + _$_5bcd[4], _$_5bcd[5])], _$_5bcd[10]))
```
翻译为
```javascript
if(typeof navigator.getBattery === 'function')
```
**或许可以从电量分析？**
当然还有
```javascript
ga = document.createElement("script")
ga.type = "text/javascript"
ga.src = "https://d1g3cc7eychvg6.cloudfront.net/9gu284?%7B%22b%22%3A%221%22%2C%22t%22%3A%220%22%2C%22s%22%3A%22TypeError%3A%20Cannot%20read%20property%20%27navigator%27%20of%20undefined%22%7D"
 s = document.getElementsByTagName('script')[0]
```
加载了一个js，不清楚是干嘛的。


